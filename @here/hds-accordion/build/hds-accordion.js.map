{"version":3,"file":"hds-accordion.js","sourceRoot":"","sources":["../src/hds-accordion.ts"],"names":[],"mappings":"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","sourcesContent":["import {customElement} from '@here/hds-base';\nimport {html, LitElement} from 'lit';\nimport {property, query} from 'lit/decorators.js';\nimport {styles} from './hds-accordion.css.js';\nimport {AccordionItem} from './hds-accordion-item.js';\n\nexport type AccordionVariant = 'default' | 'solid';\nexport type AccordionArrowPosition = 'start' | 'end';\nexport type AccordionExpandMode = 'one' | 'many';\nexport type AccordionChangePayload = {index: number; id: string; expanded: boolean};\n\n/**\n * @slot default Slot for `hds-accordion-item` elements\n *\n * @event {CustomEvent<{index: number; id: string; expanded: boolean}>} change Fired when an accordion item has expanded/collapsed `AccordionChangePayload`\n */\n@customElement('hds-accordion')\nexport class Accordion extends LitElement {\n  static styles = styles;\n  static shadowRootOptions = {...LitElement.shadowRootOptions, delegatesFocus: true};\n  @property({type: String, reflect: true}) variant: AccordionVariant = 'default';\n  @property({type: String, reflect: true, attribute: 'arrow-position'})\n  arrowPosition: AccordionArrowPosition = 'end';\n  @property({type: String, reflect: true, attribute: 'expand-mode'})\n  expandMode: AccordionExpandMode = 'many';\n  @property({type: Boolean, reflect: true, attribute: 'default-expanded'}) defaultExpanded = false;\n  @property({type: Boolean}) disabled = false;\n  @query('slot') protected slotElement!: HTMLSlotElement;\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener('change', this._onChange as EventListener);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeEventListener('change', this._onChange as EventListener);\n  }\n\n  protected updated() {\n    this._updateItems();\n  }\n\n  protected render() {\n    return html`\n      <div class=\"-hds-accordion-wrapper\" @keydown=\"${this._onKeyDown}\">\n        <slot @slotchange=\"${this._onSlotChange}\"></slot>\n      </div>\n    `;\n  }\n\n  private _onSlotChange() {\n    if (this.defaultExpanded) {\n      const items = this._getItems();\n      for (let i = 0; i < items.length; i += 1) {\n        if ((this.expandMode === 'one' && i === 0) || this.expandMode === 'many') {\n          items[i].expanded = true;\n        }\n      }\n    }\n    this._updateItems();\n  }\n\n  private _getFocusedItem() {\n    return this._getItems().find(item => item === document.activeElement);\n  }\n\n  private _focusItemByIndex(index) {\n    this._getItems()[index]?.focus();\n  }\n\n  private _onKeyDown(e: KeyboardEvent) {\n    if (['ArrowDown', 'ArrowUp', 'Home', 'End'].includes(e.key)) {\n      const focusedItem = this._getFocusedItem();\n      const itemsCount = this._getItems().length;\n\n      if (focusedItem !== undefined && itemsCount > 1) {\n        e.preventDefault();\n\n        if (e.key === 'ArrowUp') {\n          this._focusItemByIndex(focusedItem.index === 0 ? itemsCount - 1 : focusedItem.index - 1);\n        } else if (e.key === 'ArrowDown') {\n          this._focusItemByIndex(focusedItem.index === itemsCount - 1 ? 0 : focusedItem.index + 1);\n        } else if (e.key === 'Home') {\n          this._focusItemByIndex(0);\n        } else if (e.key === 'End') {\n          this._focusItemByIndex(itemsCount - 1);\n        }\n      }\n    }\n  }\n\n  private _onChange(e: CustomEvent<AccordionChangePayload>) {\n    if (this.expandMode === 'one' && e.detail.expanded) {\n      this._getItems().forEach(item => {\n        // eslint-disable-next-line no-param-reassign\n        if (item !== e.target) item.expanded = false;\n      });\n    }\n  }\n\n  private _updateItems() {\n    const items = this._getItems();\n    for (let i = 0; i < items.length; i++) {\n      items[i].variant = this.variant;\n      items[i].arrowPosition = this.arrowPosition;\n      items[i].isAccordionDisabled = this.disabled;\n      items[i].index = i;\n      items[i].isFirstChild = i === 0;\n      items[i].isLastChild = i === items.length - 1;\n    }\n  }\n\n  private _getItems() {\n    return this.slotElement\n      .assignedNodes({flatten: true})\n      .filter((e: Node) => e instanceof AccordionItem) as AccordionItem[];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'hds-accordion': Accordion;\n  }\n}\n"]}