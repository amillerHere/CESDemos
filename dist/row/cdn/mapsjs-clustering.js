
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.777.7777/HERE_NOTICE
 */

H.util.eval("xg.prototype.Dc=da(1,function(a,b){this.a.Dc(a,Ec(b)?b:this.c)});Bg.prototype.Dc=da(0,function(a,b){var c=0,d;if(!a(this)&&b--)for(;3>=c;c++)(d=this[c])&&d.Dc(a,b)});function pt(a,b){this.a=a;this.b=b}t(\"H.clustering.grid.NoisePoint\",pt);pt.prototype.wa=function(){return og(this.a)};pt.prototype.getPosition=pt.prototype.wa;pt.prototype.pc=function(){return this.a.wt};pt.prototype.getWeight=pt.prototype.pc;pt.prototype.jd=hf;pt.prototype.isCluster=pt.prototype.jd;pt.prototype.lc=function(){return this.b};pt.prototype.getMinZoom=pt.prototype.lc;pt.prototype.getData=function(){return this.a.data};pt.prototype.getData=pt.prototype.getData;function qt(a,b,c){this.g=this.b=c;this.Nh=[];this.a=0;this.f=tg(a,b,!0)}t(\"H.clustering.grid.Cluster\",qt);qt.prototype.he=function(a){this.c||(this.c=og(a));this.a+=a.wt||1;this.Nh.push(a)};qt.prototype.wa=function(){return this.c};qt.prototype.getPosition=qt.prototype.wa;qt.prototype.pc=function(){return this.a};qt.prototype.getWeight=qt.prototype.pc;qt.prototype.jd=gf;qt.prototype.isCluster=qt.prototype.jd;qt.prototype.lc=function(){return this.b};qt.prototype.getMinZoom=qt.prototype.lc;\nqt.prototype.xf=function(){return this.g};qt.prototype.getMaxZoom=qt.prototype.xf;qt.prototype.F=function(){return this.f};qt.prototype.getBoundingBox=qt.prototype.F;qt.prototype.Kg=function(a){this.te(a)};qt.prototype.forEachEntry=qt.prototype.Kg;qt.prototype.te=function(a){var b=this;if(!Da(a))throw new D(this.te,0,a);this.Nh.forEach(function(c){a(new pt(c,b.b+1))})};qt.prototype.forEachDataPoint=qt.prototype.te;function rt(a){pd.call(this);this.a=[];var b;a?Ya(b={},st,a):b=st;this.g=b;pd.call(this)}u(rt,pd);var tt={clusters:[],noisePoints:[]},st={projection:kj,min:0,max:22,eps:32,minWeight:2};p=rt.prototype;p.zc=function(a){this.a=a;this.b=!0};p.vb=function(a){this.a.push(a);this.b=!0};p.cf=function(a){this.a=this.a.concat(a);this.b=!0};p.Ne=function(a){this.a=this.a.filter(function(b){return b!==a});this.b=!0};p.o=function(){rt.l.o.call(this);delete this.a};rt.prototype.disposeInternal=rt.prototype.o;\nrt.prototype.R=kd;function ut(a){rt.call(this,a)}u(ut,rt);\nut.prototype.oi=function(a){var b=this.g,c=b.min,d=b.max,e=[],f=[],g;if(this.b){for(g=this.a;c<=d;c++){for(var h,k=void 0,l,m,n,q,r,v,w,z=c,J=g,I=e,Y=f,ba=b.eps,Ja=b.projection,ka=b.minWeight,kc=J.length,yb=Math.pow(2,z+8),od=[];w=J[--kc];)if(!w.vi){m=Ja.Ic(w).scale(yb).floor();v=yb;r=m.x;q=m.y;for(l=od.length;l--;)h=od[l],n=h.wa(),h.ui||(h.ui=Ja.Ic(n).scale(yb).floor()),n=h.ui,n=n.Sa(m),n<v&&(v=n,k=h);k&&k.F().ad(w)||(k=new qt(Ja.Qf({x:(r-ba)/yb,y:(q-ba)/yb}),Ja.Qf({x:(r+ba)/yb,y:(q+ba)/yb}),z),\nod.push(k));k.he(w);k=null}for(kc=od.length;kc--;)if(h=od[kc],l=h.pc(),l<ka)for(h=h.Nh,l=h.length;w=h[--l];)Y.push(new pt(w,z)),w.vi=!0;else I.push(h)}c=0;for(d=g.length;c<d;c++)delete g[c].vi;this.b=!1;a({clusters:e,noisePoints:f})}};function vt(a){this.a=a;a=document.createElement(\"canvas\");var b=a.getContext(\"2d\"),c=this.a,d=14*c;a.width=d;a.height=d;b.scale(c,c);b.beginPath();b.strokeStyle=\"#FFFFFF\";b.fillStyle=\"#1080DD\";b.arc(7,7,6,0,2*Math.PI,!1);b.fill();b.lineWidth=1;b.stroke();this.f=new Uj(a,{size:{w:14,h:14},anchor:{x:7,y:7}});this.b={};this.c={}}t(\"H.clustering.theme.Circular\",vt);\nfunction wt(a,b,c){var d,e=document.createElement(\"canvas\"),f=e.getContext(\"2d\");var g=a.a;var h=b*g;e.width=h;e.height=h;f.scale(g,g);g=b+\":\"+c;(d=a.b[g])?f.putImageData(d,0,0):(b/=2,f.beginPath(),f.strokeStyle=\"rgba(\"+c+\",0.2)\",f.fillStyle=\"rgba(\"+c+\",1)\",f.arc(b,b,b/5*3,0,2*Math.PI,!1),f.fill(),f.lineWidth=b/5*4,f.stroke(),a.b[g]=f.getImageData(0,0,h,h));return e}\nvt.prototype.Nl=function(a){var b=a.pc();var c=this.c[b];if(!c){if(10>b){c=wt(this,28,\"118,209,0\");var d={x:11,y:18}}else 25>b?(c=wt(this,38,\"255,105,0\"),d={x:13,y:23}):50>b?(c=wt(this,38,\"240,60,0\"),d={x:13,y:23}):100>b?(c=wt(this,38,\"181,0,21\"),d={x:13,y:23}):1E3>b?(c=wt(this,48,\"181,0,21\"),d={x:15,y:28}):(c=wt(this,66,\"181,0,21\"),d={x:20,y:38});var e=c.getContext(\"2d\");e.fillStyle=\"#FFFFFF\";e.font=\"bold 11px Arial\";e.fillText(String(b),d.x,d.y);d=c.width/this.a;c=new Uj(c,{size:{w:d,h:d},anchor:{x:d/\n2,y:d/2}});this.c[b]=c}b=new Jn(a.wa(),{icon:c,min:a.lc(),max:a.xf()});b.setData(a);return b};vt.prototype.getClusterPresentation=vt.prototype.Nl;vt.prototype.sm=function(a){var b=new Jn(a.wa(),{icon:this.f,min:a.lc()});b.setData(a);return b};vt.prototype.getNoisePresentation=vt.prototype.sm;function xt(a){rt.call(this,a);a=this.g;if(a.projection!==kj)throw new D(xt,0,\"Other projection than mercator not supported yet\");this.m=a.projection;this.f=a.eps;this.B=a.minWeight;this.s=new lj(this.m);(new Qf).a(\"cluster\",\"H.clustering.dynamicgrid.worker\");this.i=A(this.i,this);this.j=A(this.j,this)}u(xt,rt);xt.prototype.R=function(a,b){this.u=a;this.v=Ad(b)};\nxt.prototype.oi=function(a,b){var c=this.c;var d=this.u,e=this.v||0;var f=!c||!(c.zoom===e&&c.b.ea(d));if(d&&(this.b||f)){c&&3>c.Ud&&c.cancel();this.b=!1;c=this.f;if(c>=128*Fd(2,e))var g=yt;else{f=this.s;f.Ja(e);var h=f.cb(d.Fb());g=f.cb(d.Bb());h.y-=c;g.y+=c;h=f.Ie(h);var k=f.Ie(g);g=new K(h.lat,h.lng,k.lat,k.lng);c=f.Ka(c,0).lng+180;g=g.tc(h.lat,h.lng-c,k.lat,h.lng).tc(h.lat,k.lng,k.lat,k.lng+c)}c=g;h=this.a;g=[];for(f=h.length;f--;)c.ad(h[f])&&g.push(h[f]);0<g.length?(this.c=new zt(d,e,g,this.f,\nthis.B,this.m!==kj,a,b),this.c.then(this.i,this.j)):a(tt)}};xt.prototype.i=function(a){Ca(a)||(a=new x.Uint32Array(a));this.c.g(At(this,a))};xt.prototype.j=function(a){Bc(a)&&this.c.f(a)};var yt=new K(90,-180,-90,180);\nfunction At(a,b){for(var c=0,d=b[c++],e=Array(d),f=0,g=[],h=b.length,k=a.c.a,l=a.c.zoom;d--;)e[f++]=new pt(k[b[c++]],l);for(;c<h;){d=b[c++];f=k[b[c]];var m=a.s;var n=a.f;m.Ja(a.c.zoom);var q=m.cb(f);f=m.Ka(q.x-n,q.y-n);m=m.Ka(q.x+n,q.y+n);f=new K(f.lat,f.lng,m.lat,m.lng);for(f=new qt(f.Fb(),f.Bb(),l);d--;)f.he(k[b[c++]]);g.push(f)}return{clusters:g,noisePoints:e}}xt.prototype.o=function(){xt.l.o.call(this)};xt.prototype.disposeInternal=xt.prototype.o;\nfunction zt(a,b,c,d,e,f,g,h){this.b=a;this.zoom=b;this.a=c;this.g=g;this.f=h;a=c.length;g=3*a;h=new (x.Float64Array||Array)(g);for(var k;a--;)k=c[a],h[--g]=k.lat,h[--g]=k.lng,h[--g]=k.wt;he.call(this,\"cluster\",{message:[h,d,e,b,f]},void 0)}u(zt,Tf);function Bt(a,b,c){this.b=a;this.a=b;this.f=c}t(\"H.clustering.fastgrid.NoisePoint\",Bt);Bt.prototype.wa=function(){this.c||(this.c=this.b.Ka(this.a[1],this.a[0],1));return this.c};Bt.prototype.getPosition=Bt.prototype.wa;Bt.prototype.pc=function(){return this.a.a};Bt.prototype.getWeight=Bt.prototype.pc;Bt.prototype.jd=hf;Bt.prototype.isCluster=Bt.prototype.jd;Bt.prototype.lc=function(){return this.f-this.b.c};Bt.prototype.getMinZoom=Bt.prototype.lc;Bt.prototype.getData=function(){return this.a.data};\nBt.prototype.getData=Bt.prototype.getData;function Ct(a,b,c,d){this.b=a;this.a=b;this.j=c;this.R=d;this.f=Ka(this.f,this);this.c=Ka(this.c,this)}t(\"H.clustering.fastgrid.Cluster\",Ct);Ct.prototype.wa=function(){this.m||(this.m=this.b.Ka(this.a.ke,this.a.le,this.a.xb));return this.m};Ct.prototype.getPosition=Ct.prototype.wa;Ct.prototype.pc=function(){return this.a.xb};Ct.prototype.getWeight=Ct.prototype.pc;Ct.prototype.jd=gf;Ct.prototype.isCluster=Ct.prototype.jd;Ct.prototype.lc=function(){return this.j?this.j-this.b.c:-1/0};\nCt.prototype.getMinZoom=Ct.prototype.lc;Ct.prototype.xf=function(){return this.R-this.b.c};Ct.prototype.getMaxZoom=Ct.prototype.xf;Ct.prototype.F=function(){this.i||(this.i=tg(this.b.Ka(this.a.a,this.a.f,1),this.b.Ka(this.a.b,this.a.c,1),!0));return this.i};Ct.prototype.getBoundingBox=Ct.prototype.F;Ct.prototype.Kg=function(a){this.g=a;this.a.Dc(this.f,Vd)};Ct.prototype.forEachEntry=Ct.prototype.Kg;\nCt.prototype.f=function(a,b){var c=!1,d,e;a.xb>=this.b.m&&a!==this.a&&a.xb!==this.a.xb&&(this.g(new Ct(this.b,a,0,b)),c=!0);if(!c&&(d=a.entries))for(a=d.length,e=0;e<a;e++)this.g(new Bt(this.b,d[e],b));return c};Ct.prototype.te=function(a){this.s=a;this.a.Dc(this.c,Vd)};Ct.prototype.forEachDataPoint=Ct.prototype.te;Ct.prototype.c=function(a,b){var c;if(a=a.entries){var d=a.length;for(c=0;c<d;c++)this.s(new Bt(this.b,a[c],b))}return!1};function Dt(a,b,c,d,e,f){this.g=b;a&&(this.parent=a,b&1?(c=a[8],e=a[5]):(c=a[7],e=a[8]),b&2?(d=a[9],f=a[6]):(d=a[4],f=a[9]));this[7]=c;this[5]=e;this[8]=(c+e)/2;this[4]=d;this[6]=f;this[9]=(d+f)/2}p=Dt.prototype;p.Td=0;function Et(a,b){return a[b]||(++a.Td,a[b]=new Dt(a,b))}p.removeChild=function(a){var b=a.g;this[b]===a&&(delete this[b],delete a.parent,--this.Td)};p.Dc=function(a,b){for(var c=0,d=this;d=d.parent;)++c;Ft(this,a,b,c)};\nfunction Ft(a,b,c,d){var e,f;if(!b(a,d)&&c--)for(++d,e=0;4>e;e++)(f=a[e])&&Ft(f,b,c,d)}p.ke=0;p.le=0;p.xb=0;function Gt(a){this.b=a||10;Ht(this)}function Ht(a){a.head=a.a=new Dt(null,NaN,0,0,4294967296,4294967296)}function It(a,b){var c,d;for(c=0;4>c;c++)if(d=b[c])It(a,d),delete b[c];delete b.parent;delete b.entries}function Jt(a,b){var c=a.head,d;if(b){var e=b;if(e!==c)for(c=e;e=e.parent;)if(e.entries||1<e.Td)c=e}else for(;!c.entries&&2>(d=c.Td);)if(d)c=e;else break;a.head=c}\nGt.prototype.qc=function(a,b,c,d){var e=this.a;if(!(a>=e[7]&&b>=e[4]&&a<=e[5]&&b<=e[6]))throw Error(\"Coordinates out of bounds\");return Kt(this,this.a,a,b,c,this.b,d)};\nfunction Kt(a,b,c,d,e,f,g){var h=b.entries;f?b.Td?h=Kt(a,Et(b,+(c>=b[8])|+(d>=b[9])<<1),c,d,e,f-1,g):h?(h=h[0],h=Et(b,+(h[1]>=b[8])|+(h[0]>=b[9])<<1),h.entries=b.entries,h.ke=b.ke,h.le=b.le,h.xb=b.xb,h.a=b.a,h.f=b.f,h.b=b.b,h.c=b.c,delete b.entries,Jt(a,h),h=Kt(a,Et(b,+(c>=b[8])|+(d>=b[9])<<1),c,d,e,f-1,g)):(f=h=new Lt(c,d,e,g),(b.entries||(b.entries=[])).push(f),Jt(a,b)):(h||Jt(a,b),a=h=new Lt(c,d,e,g),(b.entries||(b.entries=[])).push(a));b.ke+=c*e;b.le+=d*e;b.xb+=e;b.a===B?(b.a=b.b=c,b.f=b.c=d):\n(c<b.a?b.a=c:c>b.b&&(b.b=c),d<b.f?b.f=d:d>b.c&&(b.c=d));return h}Gt.prototype.Dc=function(a,b){Ft(this.a,a,b===+b?b:this.b,0)};function Lt(a,b,c,d){this[0]=b;this[1]=a;this.a=c;this.data=d};function Mt(a){rt.call(this,a);a=this.g;this.j=a.projection;this.s=a.min;this.f=a.max;this.m=a.minWeight;this.c=7-zd(Dd(yd(1,a.eps))/Nd);this.i=new Gt(yd(this.s,this.f+this.c))}u(Mt,rt);p=Mt.prototype;p.zc=function(a){var b=0,c=a.length,d,e=new G(0,0),f=this.j,g=this.i;Mt.l.zc.call(this,a);It(g,g.a);for(Ht(g);b<c;b++)f.Ic(d=a[b],e).scale(4294967296).floor(),g.qc(e.x,e.y,d.wt,d.data);this.b=!0};p.vb=function(a){Mt.l.vb.call(this,a);this.zc(this.a)};\np.cf=function(a){for(var b=a.length,c=Mt.l.vb;b--;)c.call(this,a[b]);this.zc(this.a)};p.Ne=function(a){Mt.l.Ne.call(this,a);this.zc(this.a)};p.Ka=function(a,b,c,d){return this.j.Ka(a/c/4294967296,b/c/4294967296,d)};p.oi=function(a){if(this.b){var b={clusters:[],noisePoints:[]};Nt(this,this.i.a,0,this.f+this.c,-1/0,b,null);this.b=!1;a(b)}};\nfunction Nt(a,b,c,d,e,f,g){var h=b.xb,k;g&&(g.node.xb!==h?(f.clusters.push(new Ct(a,g.node,g.depth,c-1)),g=null):e++);g||(h>=a.m?(g={node:b,depth:c},e=c):Ot(a,b,e+1,f));if(b.Td&&d--)for(c++,h=0;4>h;h++)if(k=b[h])Nt(a,k,c,d,e,f,g),g=null;g&&f.clusters.push(new Ct(a,g.node,g.depth,a.f+a.c))}function Ot(a,b,c,d){b=b.entries;var e;if(b){var f=b.length;d=d.noisePoints;for(e=0;e<f;e++)d.push(new Bt(a,b[e],c))}else for(e=0;4>e;e++)(f=a[e])&&Ot(a,f,c,d)}p.o=function(){Mt.l.o.call(this);this.i=null};\nMt.prototype.disposeInternal=Mt.prototype.o;t(\"H.clustering.DataPoint\",function(a,b,c,d){this.lat=a;this.lng=b;this.wt=c===+c?c:1;this.data=d});function Pt(a,b){b=b||{};var c={},d=b.min||0,e=yd(d,b.max||22);d={min:d,max:e};Pt.l.constructor.call(this,d);this.ya=b.pixelRatio||Ue();Ya(c,st,d,b.clusteringOptions||{});c.minWeight=yd(st.minWeight,c.minWeight);switch(c.strategy){case Qt.DYNAMICGRID:if(c.projection!==kj)throw new D(Pt,1,\"Unsupported projection\");this.b=new xt(c);break;case Qt.GRID:this.b=new ut(c);break;default:this.b=new Mt(c)}this.b.zc(a);this.v=b.theme||new vt(this.ya);this.N=A(this.N,this);this.oa=A(this.oa,this);Rt(this)}\nu(Pt,N);t(\"H.clustering.Provider\",Pt);Pt.prototype.o=function(){Pt.l.o.call(this);this.g.ka();this.b.C();delete this.b;delete this.I;delete this.v;x.clearTimeout(this.X)};var Qt={FASTGRID:0,GRID:1,DYNAMICGRID:2};Pt.Strategy=Qt;Pt.prototype.N=function(){this.dispatchEvent(\"start\");this.b.oi(this.oa,kd)};function Rt(a,b,c){a.X&&x.clearTimeout(a.X);b&&a.b.R(b,c);a.X=x.setTimeout(a.N,150)}Pt.prototype.oa=function(a){this.dispatchEvent(\"end\");this.I=a;St(this)};\nPt.prototype.zc=function(a){this.b.zc(a);Rt(this)};Pt.prototype.setDataPoints=Pt.prototype.zc;Pt.prototype.vb=function(a){this.b.vb(a);Rt(this)};Pt.prototype.addDataPoint=Pt.prototype.vb;Pt.prototype.cf=function(a){this.b.cf(a);Rt(this)};Pt.prototype.addDataPoints=Pt.prototype.cf;Pt.prototype.Ne=function(a){this.b.Ne(a);Rt(this)};Pt.prototype.removeDataPoint=Pt.prototype.Ne;Pt.prototype.Mm=function(){return this.v};Pt.prototype.getTheme=Pt.prototype.Mm;\nPt.prototype.ao=function(a){this.v=a;this.I&&(this.g.ka(),St(this))};Pt.prototype.setTheme=Pt.prototype.ao;function St(a){var b=a.I.clusters,c=a.I.noisePoints,d=b.length,e=c.length,f=0<d+e;for(a.g.ka();e--;){var g=c[e];a.g.aa(a.v.getNoisePresentation(g))}for(;d--;)c=b[d],a.g.aa(a.v.getClusterPresentation(c));f&&a.Ra()}Pt.prototype.Ib=function(){return!0};Pt.prototype.providesDomMarkers=Pt.prototype.Ib;Pt.prototype.Jb=function(){return!0};Pt.prototype.providesMarkers=Pt.prototype.Jb;\nPt.prototype.uc=function(){return!0};Pt.prototype.providesSpatials=Pt.prototype.uc;Pt.prototype.Le=function(a,b){Rt(this,a,b)};Pt.prototype.preprocessData=Pt.prototype.Le;t(\"H.clustering.buildInfo\",function(){return If(\"H-clustering\",\"1.777.7777\",\"093b469\",{region:\"row\"})});\n");