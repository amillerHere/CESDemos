
/**
 * The code below uses open source software. Please visit the URL below for an overview of the licenses:
 * http://js.api.here.com/v3/3.1.777.7777/HERE_NOTICE
 */

H.service.util.eval("function ww(a){var b;if(a)for(xw={},b=a.length;b--;)xw[a[b]]=!0;this.Uk={}}var yw,xw={};ww.prototype.parse=function(a,b,c){var d,e,f,g,h;yw=!1;try{c=JSON.parse(c)}catch(m){yw=!0}if(c&&(d=c.metadata)){var k={spatials:[]};for(e in d){if(c=!xw[e]&&(f=zw[e]))(g=d[e])||(yw=!0,g=void 0),c=g;if(c)for(c=g.length;c--;){var l;(l=g[c])||(yw=!0,l=void 0);(h=l)&&f(b,a,this,e,h,k)}}}else yw=!0;return yw?void 0:k};ww.prototype.parse=ww.prototype.parse;\nvar zw={\"street labels\":function(a,b,c,d,e,f){var g;(g=e.vertices)||(yw=!0,g=void 0);if(g){var h,k=g.length,l;(l=0<k)||(yw=!0,l=void 0);if(l)for(h=Array(k/2);k;){var m=g[--k];l=g[--k];h[k/2]=new G(l,m)}h=h?{a:[h]}:B;k=+e[\"font size\"]/a.Ta();g=c.Uk[k];g||(Aw.lineWidth=k,g=c.Uk[k]=c.zd.fj(Aw));Bw(a,b,h,!1,g,e,d,f)}delete e.vertices},\"city center labels\":function(a,b,c,d,e,f){Bw(a,b,Cw(e,new Mh([])),!0,c.zd,e,d,f)},labels:function(a,b,c,d,e,f){var g;(g=e[\"bounding boxes\"])||(yw=!0,g=void 0);if(g){for(var h=\ng.length,k=new Mh([]),l;h--;){var m;(m=g[h])||(yw=!0,m=void 0);(l=m)&&Cw(l,k)}Bw(a,b,k,!0,c.zd,e,d,f)}delete e[\"bounding boxes\"]},buildings:function(a,b,c,d,e,f){var g=e.id,h=b.Uf[g],k,l,m,n=[],q=[];(k=e)||(yw=!0,k=void 0);if(k&&((l=k.vertices)||(yw=!0,l=void 0),l)){var r;(r=k.polygons)||(yw=!0,r=void 0);(m=r)&&n.push.apply(n,Dw(l,m));(k=k.outlines)||(yw=!0,k=void 0);(m=k)&&q.push.apply(q,Dw(l,m))}m=n.length;n.push.apply(n,q);q=new Mh(n,Vd,m);(n=n.length)||(yw=!0,n=void 0);n&&(h?(Pq(h,a,[q]),f.spatials.push(h)):\n(h=Bw(a,b,q,!0,c.zd,e,d,f,g),b.aa(h)))}};zw[\"transit stops\"]=zw.POIs=zw.labels;var Ew=[\"box 2\",\"box 1\",\"annotation box\",\"icon box\"];function Cw(a,b){for(var c=Ew.length,d,e;c--;)if(d=Ew[c],e=a[d]){var f=e[0],g=e[1],h=e[2];e=e[3];b.a.push([new G(f,g),new G(f+h,g),new G(f+h,g+e),new G(f,g+e)]);delete a[d]}return b}\nfunction Dw(a,b){var c=b.length,d,e,f;if(0<c)for(e=Array(c);c--;)if((d=b[c])||(yw=!0,d=void 0),d){var g=d.length;if(0<g)for(e[c]=f=Array(g);g--;){var h=2*d[g];f[g]=new G(a[h],a[h+1])}}return e||[]}var Fw={};function Bw(a,b,c,d,e,f,g,h,k){Fw.style=e;d=new Lq(b,d,k,Fw);c&&Pq(d,a,[c]);Gw(f);f.category=g;d.setData(f);h.spatials.push(d);d.ga(b);return d}ww.prototype.zd=new O({strokeColor:\"transparent\",fillColor:\"transparent\",lineWidth:0});var Aw={};\nfunction Gw(a){var b,c=!1;switch(typeof a){case \"object\":if(a instanceof Array)for(b=a.length;b--;)Gw(a[b])?c=!0:delete a[b];else if(a)for(b in a)Gw(a[b])?c=!0:delete a[b];break;case \"number\":c=!0;break;default:c=!!a}return c};function Hw(a,b,c){c=c||{};b=b||{};var d=c.tileType||\"maptile\",e=c.scheme||\"normal.day\";S.call(this,{min:0,max:20});!0===b.pois&&(b.pois=\"!F\");this.I=b;if(!(a&&a instanceof Iw))throw Error(\"InvalidArgument: service required\");this.u=a;this.i=A(this.i,this);this.u.addEventListener(\"versionupdate\",this.i);this.B=a.D().clone().K(d+\"/\"+a.nc()+\"/\"+e).G(Jw).G(b);this.X=a.g||null;this.N=c.pixelRatio||c.pixelratio||Ue();this.tileSize=c.tileSize||256;this.tileType=d;this.scheme=e;this.b=new Vq(new ww(c.categoryFilter));\nthis.b.ga(this);this.v=A(this.v,this);this.b.addEventListener(\"update\",this.v);S.call(this,{min:0,max:20});this.m(new Pk(c.tileCacheSize||256,A(this.Y,this)))}u(Hw,S);t(\"H.service.metaInfo.TileProvider\",Hw);Hw.prototype.Y=function(a,b){a=b.Na();for(var c=a.length,d;c--;)d=a[c],delete d.a[b.key],d.release();b.data&&(up.push(b.Sf(),this.tileSize),b.Tf())};Hw.prototype.v=function(){this.dispatchEvent(\"update\")};\nHw.prototype.J=function(a,b,c,d,e){var f=this.B.clone(),g=this.X,h=this.tileSize,k=this.getTileKey(a,b,c);k=this.Cb().get(k);var l;if(k&&!k.Qd()){d(up.pop(this.tileSize),null);var m={cancel:function(){}}}else{g&&f.za(g[(c+b+a)%g.length]);f.K(c+\"/\"+a+\"/\"+b+\"/\"+h+\"/png8\");var n=sp.setTimeout(function(){l=new uf(\"text/plain\",f.toString());l.then(function(q){d(null,q)},e)},500)}return m||{cancel:function(){l?l.cancel():sp.clearTimeout(n)}}};Hw.prototype.requestInternal=Hw.prototype.J;\nHw.prototype.Sb=function(a,b,c,d,e){var f=this.b;var g=d||up.pop(this.tileSize);if(d)a=this.Cb().get(this.getTileKey(a,b,c)),a.T(d);else if(d=a=new Zk(this.gd(a,b,c),a,b,c,this.tileSize,this.N,c,f),delete d.j,d.m=e,a.T(g))for(e=a.Na(),g=e.length;g--;)e[g].Zf();else up.push(g,this.tileSize);return a};Hw.prototype.createTileInternal=Hw.prototype.Sb;Hw.prototype.C=function(){this.b.C();this.u.removeEventListener(\"versionupdate\",this.i);S.prototype.C.call(this)};Hw.prototype.dispose=Hw.prototype.C;\nHw.prototype.i=function(){var a=this.u;this.B=a.D().clone().K(this.tileType+\"/\"+a.nc()+\"/\"+this.scheme).G(Jw).G(this.I);this.reload(!1)};var Jw={metadata:\"metaonly\",mgen:\"2\"};function Iw(a){Iw.l.constructor.call(this,Iw,a);a=Pp(this,a);this.g=a.shards;(this.c=a.ignoreTypes?null:a.type)&&this.D().za(this.c);this.f=a.version;this.m=new Xp;\"newest\"===this.f&&Kw(this)}u(Iw,Op);t(\"H.service.metaInfo.Service\",Iw);Iw.prototype.a=function(){return{type:\"base\",version:\"newest\",subDomain:\"maps.ls\",path:\"maptile/2.1\",shards:[\"1\",\"2\",\"3\",\"4\"]}};Iw.CONFIG_KEY=\"metaInfo\";function Lw(a,b){for(var c={},d=a[b+\"s\"][b],e=d.length;e--;)c[d[e].id]=d[e];a[b+\"s\"]=c}Iw.prototype.zj=function(){return this.c};\nIw.prototype.nc=function(){return this.f};Iw.prototype.getVersion=Iw.prototype.nc;Iw.prototype.la=function(){return this.m};Iw.prototype.getCopyrights=Iw.prototype.la;\nfunction Kw(a){var b=a.D().clone().K(\"info\").G({output:\"json\"});a.g&&b.za(a.g[0]);a.J(b,function(c){c=c.response;var d;Lw(c,\"map\");Lw(c,\"scheme\");Lw(c,\"tiletype\");Lw(c,\"format\");Lw(c,\"resolution\");Lw(c,\"language\");if(\"newest\"===a.f&&\"traffic\"!==a.c)for(d in c.maps)c.maps[d].hash&&c.maps[d].newest&&(a.f=c.maps[d].hash,a.dispatchEvent(\"versionupdate\"));a.s=c;a.dispatchEvent(\"infoupdate\")},function(c){throw c;})}Iw.prototype.Rg=function(){return this.s};Iw.prototype.getInfo=Iw.prototype.Rg;\nIw.prototype.oe=function(a,b,c,d,e,f){return new Hw(this,d,{tileSize:a,pixelRatio:b,categoryFilter:c,tileType:e,scheme:f})};Iw.prototype.createTileProvider=Iw.prototype.oe;Iw.prototype.hc=function(a,b,c,d,e,f){return new ql(this.oe(a,b,c,d,e,f))};Iw.prototype.createTileLayer=Iw.prototype.hc;W.prototype.oj=function(a){return this.Qa(Iw,a)};W.prototype.getMetaInfoService=W.prototype.oj;(function(){var a=W.prototype.createDefaultLayers;W.prototype.createDefaultLayers=function(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g),k={},l=this.oj();\"object\"===typeof b&&(g=b,b=g.tileSize,c=g.ppi,d=g.lg,e=g.lg2,f=g.style,g=g.pois);b=b||256;var m=320===c?2:1;if(0>[72,250,320,500].indexOf(+c)){if(c!==B)throw new D(this.lf,1,c);}else k.ppi=+c;d&&(k.lg=d);e&&(k.lg2=e);f&&(k.style=f);g&&(k.pois=g);h.raster.normal.metaInfo=l.hc(b,m,[\"buildings\"],k);return h}})();\n");